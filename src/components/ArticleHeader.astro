---
// TODO: Make a articleHeader type
type Props = {
    articleHeader: {
        title: string;
        description: string;
        date: string;
        readTime: number;
        tags: string[];
        // TODO: try replacing this with the markdown prop headings
        sections: string[];
        imgUrl?: string;
        repoUrl?: string;
    };
}

const {articleHeader} = Astro.props;

function groupTags(tags: string[], displayNumber: number): {displayTags: string[], hiddenTags: string[],}  {
    return {
        displayTags: tags.slice(0, displayNumber),
        hiddenTags: tags.slice(displayNumber)
    } 
}

const {displayTags, hiddenTags} = groupTags(articleHeader.tags, 3);
---

<header class="w-full flex items-center justify-center flex-col gap-y-6 pb-6 border-b border-primary"> <!-- TODO: add a repo button to the header image -->
    { articleHeader.imgUrl && (
            <figure class="w-full h-96 bg-mischka rounded-regular overflow-hidden">
                <img src={articleHeader.imgUrl} alt="Placholder Img">
            </figure>
        )
    }
    <!-- TODO: maybe put the github logo next to the header to indicate it is a link to github -->
    <div class="w-full">
<a href={articleHeader.repoUrl} class={`${(articleHeader.repoUrl && (`link link-secondary link-hover`))}`}>
            <h2 class={`text-4xl font-semibold ${articleHeader.repoUrl || ('text-primary')}`}>{articleHeader.title}</h2>
        </a>
    </div>
    <div class="w-full">
        <span class="text-xl italic">{articleHeader.description}</span>
    </div>
    <div class="w-full flex justify-start items-center text-lg text-primary flex-wrap gap-2">
        <span>{articleHeader.date}</span> 
        <span>|</span>
        <span>{articleHeader.readTime} read time</span>
        <span>|</span>
        {displayTags.map(tag => (
            <span class="badge badge-outline badge-accent text-lg">#{tag}</span>
        ))}
        {((articleHeader.tags.length - displayTags.length) == 0)? "" :(
        <span class={`${(articleHeader.tags.length - displayTags.length) == 0 || 
            (`tooltip tooltip-bottom tooltip-primary`)}`} 
            data-tip={hiddenTags.map(tag => tag).join(", ")}>
                <span class="link link-accent link-hover font-semibold">+{articleHeader.tags.length - displayTags.length}</span>
             </span>
        )}
    </div> 
    <div class="w-full flex flex-col justify-center items-start gap-2">
        <h4 class="text-2xl font-semibold text-primary">Content:</h4>
        <ol class="list-disc list-inside text-lg flex flex-col gap-4">
            {articleHeader.sections.map(section => (
            <li>
                <a href={`#${section.replaceAll(' ', '-').toLowerCase()}`} 
                    class="link link-hover link-secondary text-xl">{section}</a>
            </li>
            ))}
        </ol>
    </div>
</header>
